'use strict';var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i['return'])_i['return']()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();(function(){var searchBarConfig={};var searchBarMain=null;window.StockSearchBar={init:function init(config){searchBarConfig=config;window.addEventListener('StockSearchBarReady',function(){var sbm=searchBarMain();window.StockSearchBar.getFilters=sbm.getFilters;window.StockSearchBar.setFilters=sbm.setFilters;sbm.init()},false)}};searchBarMain=function searchBarMain(){var AdobeStock=window.AdobeStock;var SB=searchBarConfig;var includePath=window.StockSearchBar.PATH;function getTrackingUrl(url){return'//clk.tradedoubler.com/click?p('+SB.programID+')a('+SB.advertiserID+')g('+SB.adID+')url('+encodeURIComponent(url)+')'}var stockHomeUrl=getTrackingUrl('https://stock.adobe.com');var fmfUrl=getTrackingUrl('https://stock.adobe.com/plans');var sbHeader='<div class="astock-searchbar-header"><a href="'+stockHomeUrl+'" target="_blank"><img src="'+includePath+'/adobe_stock_logo-400.png"></a><p>First month free with <a href="'+fmfUrl+'" class="astock-searchbar-link" target="_blank">Adobe Stock annual plans</a>.</p></div>';function parseFilters(filters){var searchFilters={};var $jq=window.StockSearchBar.$jq;if(!filters)return;var filterMap=Object.entries(filters);var stkParams=AdobeStock.SEARCH_PARAMS;filterMap.forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],currentValue=_ref2[1];var value=currentValue;if(Object.prototype.hasOwnProperty.call(stkParams,key)){if(key==='SIMILAR_URL'){if(value!==''&&value!==undefined){var firstImg=$jq(value+' img')[0]||$jq(''+value)[0];var url=$jq(firstImg).attr('src');if(url!==''&&url!==undefined){searchFilters[stkParams[key]]=url}}}else if(key==='WORDS'){if(value&&value[0]){var phrase=$jq(value[0]).text();if(phrase){var keywords=window.StockSearchBar.keywordx.extract(phrase,{language:'english',remove_digits:true,return_changed_case:true,remove_duplicates:true});var keywordCount=value[1]?value[1]:1;var searchWords=keywords.length>0?keywords.slice(0,keywordCount).join(' '):'';searchFilters[stkParams[key]]=searchWords}}}else if(value!==''&&value!==undefined){if(key==='THUMBNAIL_SIZE'){var sizes=[110,160,220,240,500,1000];var targetSize=value;if(sizes.indexOf(targetSize)<0){value=sizes.reduce(function(a,b){var newSize=Math.abs(a-targetSize)<Math.abs(b-targetSize)?a:b;return newSize})}}searchFilters[stkParams[key]]=value}}});return searchFilters}function $getContDiv(el){var mainClass='astock-searchbar';var dataId='searchbar';var $jq=window.StockSearchBar.$jq;var $tempDiv=$jq(el);var $dataDiv=$tempDiv.find('[data-id='+dataId+']');if($dataDiv.length>0){$tempDiv=$dataDiv}else if($tempDiv.length>0){if(!$tempDiv.hasClass(mainClass)){var $mainDiv=$jq(document.createElement('div'));$mainDiv.addClass(mainClass);$tempDiv=$mainDiv;$jq(el).append($tempDiv)}$tempDiv.attr('data-id',dataId)}else{throw new Error('Stock SearchBar error: Container does not exist. Set "contId" to a valid selector.')}return $tempDiv}function updateUiThumbs(files){var wrapClass='astock-searchbar-wrap';var bodyClass='astock-searchbar-body';var itemClass='astock-searchbar-item';var tipClass='astock-searchbar-tip';var $jq=window.StockSearchBar.$jq;var $sb=$getContDiv(SB.contId);var $wrapDiv=$jq(document.createElement('div'));$wrapDiv.addClass(wrapClass);var $thumbsDiv=$jq(document.createElement('div'));$thumbsDiv.addClass(bodyClass);if($sb.width()<=150){itemClass=itemClass+' item-small'}files.forEach(function(asset){var tag=asset[AdobeStock.RESULT_COLUMNS.THUMBNAIL_HTML_TAG];var url=getTrackingUrl(asset[AdobeStock.RESULT_COLUMNS.DETAILS_URL]);var range=document.createRange();var thumb=range.createContextualFragment(tag);var div=document.createElement('div');div.className=itemClass;var link=document.createElement('a');link.href=url;link.target='_blank';if(SB.tooltips){var tip=document.createElement('div');tip.className=tipClass;var tipText=thumb.querySelector('img').title;if(tipText!==''&&tipText!==undefined){tip.textContent=tipText;thumb.querySelector('img').removeAttribute('title');link.appendChild(tip);var $tip=$jq(tip);var $link=$jq(link);var showTip=function showTip(el){el.stopPropagation();el.preventDefault();var $img=$jq(el.currentTarget);var $off1=$img.offset();var $off2=$sb.offset();var newPos={top:$off1.top-$off2.top+$img.height(),left:$off1.left-$off2.left+$img.width()};$tip.css({top:newPos.top,left:newPos.left});$tip.show();$sb.append($tip)};var hideTip=function hideTip(el){$tip.css($jq(el.currentTarget).offset());$tip.hide();$link.append($tip)};$jq(link).hover(showTip,hideTip)}}link.appendChild(thumb);div.appendChild(link);$thumbsDiv.append(div)});$wrapDiv.append($thumbsDiv);$sb.append($wrapDiv);$thumbsDiv.masonry({itemSelector:'.'+itemClass});$thumbsDiv.imagesLoaded().progress(function(){$thumbsDiv.masonry('layout')}).done(function(){$sb.addClass('astock-searchbar-fadein');window.setTimeout(function(){$sb.css({visibility:'visible',opacity:1});$thumbsDiv.masonry('layout')},1000)})}function doSearch(params){var defaultParams={offset:0,limit:16};var searchParams=Object.assign(defaultParams,params);var queryParams={locale:'en-US',search_parameters:searchParams};var resultColumns=[AdobeStock.RESULT_COLUMNS.THUMBNAIL_HTML_TAG,AdobeStock.RESULT_COLUMNS.DETAILS_URL,AdobeStock.RESULT_COLUMNS.NB_RESULTS];var stock=new AdobeStock(SB.apiKey,SB.appName,AdobeStock.ENVIRONMENT.PROD);var iterator=stock.searchFiles(null,queryParams,resultColumns);iterator.next().then(function(){var response=iterator.getResponse();if(response.nb_results>0){updateUiThumbs(response.files)}else{}})}return{init:function init(){var $jq=window.StockSearchBar.$jq;var $searchBar=$getContDiv(SB.contId);var $header=$jq(sbHeader);var headerUrl=$header.find('a').attr('href');$searchBar.append($header);doSearch(parseFilters(SB.filters))},getFilters:function getFilters(){},setFilters:function setFilters(filters){}}};window.StockSearchBar.PATH=function(){var filename='fileName';var stack='stack';var stacktrace='stacktrace';var sourceUrl='sourceURL';var current='currentScript';var loc=null;var matcher=function matcher(name,matchedLoc){loc=matchedLoc};if(document[current]&&document[current].src!==''){loc=document[current].src;return loc.slice(0,loc.lastIndexOf('/')+1)}try{0();return false}catch(ex){if(filename in ex){loc=ex[filename]}else if(sourceUrl in ex){loc=ex[sourceUrl]}else if(stacktrace in ex){ex[stacktrace].replace(/called from line \d+, column \d+ in (.*):/gm,matcher)}else if(stack in ex){ex[stack].replace(/at.*?\(?(\S+):\d+:\d+\)?$/g,matcher)}return loc.slice(0,loc.lastIndexOf('/')+1)}}();function jqLoaded(){var includePath=window.StockSearchBar.PATH;jQuery(document).ready(function(jQuery){var SS=window.StockSearchBar;SS.$jq=jQuery.noConflict();var $jq=SS.$jq;var reqs={keywordx:'keywordx.min.js',imagesloaded:'imagesloaded.pkgd.min.js',adobestocklib:'adobestocklib.min.js',masonry:'masonry.pkgd.min.js'};$jq.when($jq.getScript(''+includePath+reqs.adobestocklib),$jq.getScript(''+includePath+reqs.masonry),$jq.getScript(''+includePath+reqs.imagesloaded),$jq.getScript(''+includePath+reqs.keywordx),$jq.Deferred(function(deferred){$jq(deferred.resolve)})).done(function(){SS.keywordx=window.keywordx;SS.Masonry=window.Masonry;var event=new Event('StockSearchBarReady');window.dispatchEvent(event)}).fail(function(jqXHR,textStatus,errorThrown){})})}var domReadyHandler=function domReadyHandler(a){var b=document;var c='addEventListener';if(b[c])b[c]('DOMContentLoaded',a);else window.attachEvent('onload',a)};domReadyHandler(function(){if(typeof window.jQuery==='undefined'&&!window.jQuery){var jQ=document.createElement('script');jQ.type='text/javascript';jQ.onload=jQ.onreadystatechange;jQ.onload=jqLoaded;jQ.src=window.StockSearchBar.PATH+'/jquery.min.js';document.body.appendChild(jQ)}else{jqLoaded()}})})();

//# sourceMappingURL=sdk_searchbar.min.js.map