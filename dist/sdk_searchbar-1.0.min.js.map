{"version":3,"sources":["../src/sdk_searchbar-1.0.js"],"names":[],"mappings":"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","file":"sdk_searchbar-1.0.min.js","sourcesContent":["(() => {\r\n  let searchBarConfig = {};\r\n  let searchBarMain = null;\r\n  // expose global object\r\n  window.StockSearchBar = {\r\n    init: (config) => {\r\n      searchBarConfig = config;\r\n      window.addEventListener('StockSearchBarReady', () => {\r\n        console.log('SearchBar ready');\r\n        const sbm = searchBarMain();\r\n        window.StockSearchBar.getFilters = sbm.getFilters;\r\n        window.StockSearchBar.setFilters = sbm.setFilters;\r\n        sbm.init();\r\n      }, false);\r\n    },\r\n  };\r\n  searchBarMain = () => {\r\n    const AdobeStock = window.AdobeStock;\r\n    const SB = searchBarConfig;\r\n    const includePath = window.StockSearchBar.PATH;\r\n    const sbHeader = `<div class=\"astock-searchbar-header\"><a href=\"https://stock.adobe.com\" target=\"_blank\"><img src=\"${includePath}/adobe_stock_logo-400.png\"></a></div>`;\r\n    function getTrackingUrl(url) {\r\n      // clk.tradedoubler.com/click?p(ProgramID)&a(AdvertiserID)&g(AdID)url(TARGET_URL)\r\n      return `//clk.tradedoubler.com/click?p(${SB.programID})a(${SB.advertiserID})g(${SB.adID})url(${encodeURIComponent(url)})`;\r\n    }\r\n    function parseFilters(filters) {\r\n      const searchFilters = {};\r\n      const $jq = window.StockSearchBar.$jq;\r\n      // iterate over object using method that won't bother eslint!\r\n      const filterMap = Object.entries(filters);\r\n      const stkParams = AdobeStock.SEARCH_PARAMS;\r\n      // lookup Stock keyname and map to search filter name\r\n      filterMap.forEach(([key, currentValue]) => {\r\n        let value = currentValue;\r\n        if (Object.prototype.hasOwnProperty.call(stkParams, key)) {\r\n          if (key === 'SIMILAR_URL') {\r\n            if (value !== '' && value !== undefined) {\r\n              const firstImg = $jq(`${value} img`)[0] || $jq(`${value}`)[0];\r\n              const url = $jq(firstImg).attr('src');\r\n              if (url !== '' && url !== undefined) {\r\n                searchFilters[stkParams[key]] = url;\r\n              }\r\n            }\r\n          } else if (key === 'WORDS') {\r\n            // value should be array ['DOM element', keyword count]\r\n            if (value && value[0]) {\r\n              const phrase = $jq(value[0]).text();\r\n              // if element has text get keywords\r\n              if (phrase) {\r\n                const keywords = window.StockSearchBar.keywordx.extract(phrase, {\r\n                  language: 'english',\r\n                  remove_digits: true,\r\n                  return_changed_case: true,\r\n                  remove_duplicates: true,\r\n                });\r\n                // if count is not supplied default to 1\r\n                const keywordCount = (value[1]) ? value[1] : 1;\r\n                const searchWords = (keywords.length > 0) ? keywords.slice(0, keywordCount).join(' ') : '';\r\n                console.log('keywords: %o\\nsearching on %s', keywords, searchWords);\r\n                searchFilters[stkParams[key]] = searchWords;\r\n              }\r\n            }\r\n          } else if (value !== '' && value !== undefined) {\r\n            // validate size\r\n            if (key === 'THUMBNAIL_SIZE') {\r\n              const sizes = [110, 160, 220, 240, 500, 1000];\r\n              const targetSize = value;\r\n              // check if size is in array of allowed sizes\r\n              if (sizes.indexOf(targetSize) < 0) {\r\n                value = sizes.reduce((a, b) => {\r\n                  const newSize = (Math.abs(a - targetSize) < Math.abs(b - targetSize) ? a : b);\r\n                  return newSize;\r\n                });\r\n                console.warn('Thumbnail size of %s is not valid. Closest size is %s', targetSize, value);\r\n              }\r\n            }\r\n            searchFilters[stkParams[key]] = value;\r\n          }\r\n        }\r\n      });\r\n      return searchFilters;\r\n    }\r\n    // returns container div from selector and adds main class\r\n    function $getContDiv(el) {\r\n      const mainClass = 'astock-searchbar';\r\n      const dataId = 'searchbar';\r\n      // get reference to jQuery\r\n      const $jq = window.StockSearchBar.$jq;\r\n      // get reference to target div and data node (might be same)\r\n      let $tempDiv = $jq(el);\r\n      const $dataDiv = $tempDiv.find(`[data-id=${dataId}]`);\r\n      // if data node exists, return it\r\n      if ($dataDiv.length > 0) {\r\n        $tempDiv = $dataDiv;\r\n      // does target node exist\r\n      } else if ($tempDiv.length > 0) {\r\n        // does target node contain main class\r\n        if (!$tempDiv.hasClass(mainClass)) {\r\n          // create new div to be container\r\n          const $mainDiv = $jq(document.createElement('div'));\r\n          // add main class\r\n          $mainDiv.addClass(mainClass);\r\n          // add new container under target and return that\r\n          $tempDiv = $mainDiv;\r\n          $jq(el).append($tempDiv);\r\n        }\r\n        // add data node\r\n        $tempDiv.attr('data-id', dataId);\r\n      // neither exists, throw exception\r\n      } else {\r\n        throw (new Error('Stock SearchBar error: Container does not exist. Set \"contId\" to a valid selector.'));\r\n      }\r\n      return $tempDiv;\r\n    }\r\n    // creates thumbs and inserts -- input is json array\r\n    function updateUiThumbs(files) {\r\n      const wrapClass = 'astock-searchbar-wrap';\r\n      const bodyClass = 'astock-searchbar-body';\r\n      let itemClass = 'astock-searchbar-item';\r\n      const tipClass = 'astock-searchbar-tip';\r\n      // get reference to jQuery\r\n      const $jq = window.StockSearchBar.$jq;\r\n      const $sb = $getContDiv(SB.contId);\r\n      // wrap thumbnails in container to allow scrolling\r\n      const $wrapDiv = $jq(document.createElement('div'));\r\n      $wrapDiv.addClass(wrapClass);\r\n      const $thumbsDiv = $jq(document.createElement('div'));\r\n      $thumbsDiv.addClass(bodyClass);\r\n      // if body width is less than 150px, apply small item size\r\n      if ($sb.width() <= 150) {\r\n        itemClass = `${itemClass} item-small`;\r\n      }\r\n      // populate with images using html returned in json\r\n      files.forEach((asset) => {\r\n        // get html tag\r\n        const tag = asset[AdobeStock.RESULT_COLUMNS.THUMBNAIL_HTML_TAG];\r\n        // get url to details page on Stock and wrap inside affiliate tracking url\r\n        const url = getTrackingUrl(asset[AdobeStock.RESULT_COLUMNS.DETAILS_URL]);\r\n        // convert html string into dom element\r\n        const range = document.createRange();\r\n        const thumb = range.createContextualFragment(tag);\r\n        // create div wrapper\r\n        const div = document.createElement('div');\r\n        div.className = itemClass;\r\n        // create anchor with link to details\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.target = '_blank';\r\n        // if captions are enabled\r\n        if (SB.tooltips) {\r\n          // create tool tip from image title\r\n          const tip = document.createElement('div');\r\n          tip.className = tipClass;\r\n          // get title text from document-fragment\r\n          const tipText = thumb.querySelector('img').title;\r\n          if (tipText !== '' && tipText !== undefined) {\r\n            tip.textContent = tipText;\r\n            thumb.querySelector('img').removeAttribute('title');\r\n            link.appendChild(tip);\r\n            // create hover behavior for tip\r\n            const $tip = $jq(tip);\r\n            const $link = $jq(link);\r\n            const showTip = (el) => {\r\n              el.stopPropagation();\r\n              el.preventDefault();\r\n              const $img = $jq(el.currentTarget);\r\n              const $off1 = $img.offset();\r\n              const $off2 = $sb.offset();\r\n              const newPos = {\r\n                top: ($off1.top - $off2.top) + $img.height(),\r\n                left: ($off1.left - $off2.left) + $img.width(),\r\n              };\r\n              $tip.css({\r\n                top: newPos.top,\r\n                left: newPos.left,\r\n              });\r\n              // console.log('final pos', newPos);\r\n              $tip.show();\r\n              // change parent to main div\r\n              $sb.append($tip);\r\n            };\r\n            const hideTip = (el) => {\r\n              $tip.css($jq(el.currentTarget).offset());\r\n              $tip.hide();\r\n              // reset parent to link\r\n              $link.append($tip);\r\n            };\r\n            // $jq(thumb.querySelector('img')).hover(showTip);\r\n            $jq(link).hover(showTip, hideTip);\r\n          }\r\n        }\r\n        // wrap link around image and add to document\r\n        link.appendChild(thumb);\r\n        div.appendChild(link);\r\n        $thumbsDiv.append(div);\r\n      });\r\n      $wrapDiv.append($thumbsDiv);\r\n      $sb.append($wrapDiv);\r\n      // init Masonry\r\n      $thumbsDiv.masonry({\r\n        itemSelector: `.${itemClass}`,\r\n      });\r\n      // listen for images loaded event\r\n      $thumbsDiv.imagesLoaded()\r\n        .progress(() => {\r\n          $thumbsDiv.masonry('layout');\r\n        })\r\n        .done(() => {\r\n          console.log('all images successfully loaded');\r\n          // show search bar\r\n          $sb.addClass('astock-searchbar-fadein');\r\n          // make sure it is visible in case class is missing\r\n          window.setTimeout(() => {\r\n            $sb.css({\r\n              visibility: 'visible',\r\n              opacity: 1,\r\n            });\r\n            // call Masonry layout one final time for Firefox!\r\n            $thumbsDiv.masonry('layout');\r\n          }, 1000);\r\n        });\r\n    }\r\n    // runs search using sdk\r\n    function doSearch(params) {\r\n      // default filters\r\n      const defaultParams = {\r\n        offset: 0,\r\n        limit: 16,\r\n      };\r\n      // merge default filters with params from config\r\n      const searchParams = Object.assign(defaultParams, params);\r\n      const queryParams = {\r\n        locale: 'en-US',\r\n        search_parameters: searchParams,\r\n      };\r\n      // result fields to get back\r\n      const resultColumns = [\r\n        AdobeStock.RESULT_COLUMNS.THUMBNAIL_HTML_TAG,\r\n        AdobeStock.RESULT_COLUMNS.DETAILS_URL,\r\n        AdobeStock.RESULT_COLUMNS.NB_RESULTS,\r\n      ];\r\n      console.log('Search query: %o', searchParams);\r\n      // create sdk instance\r\n      const stock = new AdobeStock(SB.apiKey, SB.appName, AdobeStock.ENVIRONMENT.PROD);\r\n      // execute search and load results\r\n      const iterator = stock.searchFiles(null, queryParams, resultColumns);\r\n      // iterate over returned Promise\r\n      iterator.next().then(() => {\r\n        const response = iterator.getResponse();\r\n        // only update UI if there are results\r\n        if (response.nb_results > 0) {\r\n          updateUiThumbs(response.files);\r\n        } else {\r\n          console.log('no results from Stock');\r\n        }\r\n      });\r\n    }\r\n    return {\r\n      init: () => {\r\n        const $jq = window.StockSearchBar.$jq;\r\n        // create search results\r\n        const $searchBar = $getContDiv(SB.contId);\r\n        // create stock header\r\n        const $header = $jq(sbHeader);\r\n        const headerUrl = $header.find('a').attr('href');\r\n        $header.find('a').attr('href', getTrackingUrl(headerUrl));\r\n        $searchBar.append($header);\r\n        // extract search options and run search\r\n        doSearch(parseFilters(SB.filters));\r\n      },\r\n      getFilters: () => { console.log(SB); },\r\n      setFilters: (filters) => { console.log(filters); },\r\n    };\r\n  };\r\n  // Get current path of script by triggering a stack trace\r\n  /*! @source https://gist.github.com/eligrey/5426730 */\r\n  window.StockSearchBar.PATH = (() => {\r\n    const filename = 'fileName';\r\n    const stack = 'stack';\r\n    const stacktrace = 'stacktrace';\r\n    let loc = null;\r\n    const matcher = (name, matchedLoc) => {\r\n      loc = matchedLoc;\r\n    };\r\n\r\n    try {\r\n      0(); // throws error\r\n      return false;\r\n    } catch (ex) {\r\n      if (filename in ex) { // Firefox\r\n        loc = ex[filename];\r\n      } else if (stacktrace in ex) { // Opera\r\n        ex[stacktrace].replace(/called from line \\d+, column \\d+ in (.*):/gm, matcher);\r\n      } else if (stack in ex) { // WebKit, Blink, and IE10\r\n        ex[stack].replace(/at.*?\\(?(\\S+):\\d+:\\d+\\)?$/g, matcher);\r\n      }\r\n      return loc.slice(0, loc.lastIndexOf('/') + 1);\r\n    }\r\n  })();\r\n\r\n  // notifies main script when everything is loaded\r\n  function jqLoaded() {\r\n    // get current path of script\r\n    const includePath = window.StockSearchBar.PATH;\r\n    jQuery(document).ready((jQuery) => {\r\n      const SS = window.StockSearchBar;\r\n      SS.$jq = jQuery.noConflict();\r\n      const $jq = SS.$jq;\r\n      const reqs = {\r\n        keywordx: 'keywordx.min.js',\r\n        imagesloaded: 'imagesloaded.pkgd.min.js',\r\n        adobestocklib: 'adobestocklib.min.js',\r\n        masonry: 'masonry.pkgd.min.js',\r\n      };\r\n      // load other libraries using a promise\r\n      // https://stackoverflow.com/a/11803418/9421005\r\n      $jq.when(\r\n        $jq.getScript(`${includePath}${reqs.adobestocklib}`),\r\n        $jq.getScript(`${includePath}${reqs.masonry}`),\r\n        $jq.getScript(`${includePath}${reqs.imagesloaded}`),\r\n        $jq.getScript(`${includePath}${reqs.keywordx}`),\r\n        $jq.Deferred((deferred) => {\r\n          $jq(deferred.resolve);\r\n        }),\r\n      ).done(() => {\r\n        console.log('jQuery %s and all libraries loaded.', $jq().jquery);\r\n        // dispatch event that searchbar is ready to load\r\n        SS.keywordx = window.keywordx;\r\n        SS.Masonry = window.Masonry;\r\n        const event = new Event('StockSearchBarReady');\r\n        // Dispatch the event.\r\n        window.dispatchEvent(event);\r\n      }).fail((jqXHR, textStatus, errorThrown) => {\r\n        console.error(errorThrown);\r\n      });\r\n    });\r\n  }\r\n\r\n  const domReadyHandler = (a) => {\r\n    const b = document;\r\n    const c = 'addEventListener';\r\n    if (b[c]) b[c]('DOMContentLoaded', a);\r\n    else window.attachEvent('onload', a);\r\n  };\r\n\r\n  domReadyHandler(() => {\r\n    // check for jQuery and load conditionally\r\n    if (typeof window.jQuery === 'undefined' && !window.jQuery) {\r\n      const jQ = document.createElement('script');\r\n      jQ.type = 'text/javascript';\r\n      jQ.onload = jQ.onreadystatechange;\r\n      jQ.onload = jqLoaded;\r\n      jQ.src = `${window.StockSearchBar.PATH}/jquery.min.js`;\r\n      document.body.appendChild(jQ);\r\n    } else {\r\n      jqLoaded();\r\n    }\r\n  });\r\n})();\r\n"]}